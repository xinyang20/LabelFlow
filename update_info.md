# Quick Label v0.0.2 更新说明

## 🎉 重大功能更新

### 📁 全新的标注文件存储格式
- **独立JSON文件**：每个图片现在对应一个独立的JSON标注文件，告别单一labels.json的限制
- **文件名对应**：JSON文件名与图片文件名保持一致（仅扩展名不同），便于管理和查找
- **向后兼容**：完全兼容旧版本的labels.json格式，无缝升级体验

### 🎯 自定义保存路径
- **灵活保存**：支持自定义标注文件保存路径，不再局限于图片所在目录
- **持久设置**：保存路径设置在切换工作目录前保持有效
- **智能默认**：未设置时自动保存在图片文件所在目录

### 🔄 智能自动保存系统
- **双模式支持**：
  - 自动保存模式：切换图片时自动保存标注内容
  - 手动保存模式：切换前弹出保存确认对话框
- **空内容优化**：智能识别空标注内容，避免生成无意义的空文件
- **关闭保护**：程序关闭时根据内容和设置智能处理保存逻辑

### 🛡️ 数据备份保护
- **base64编码**：自动生成图片的base64编码并保存在JSON文件中
- **数据恢复**：当原图片文件损坏或丢失时，可从标注文件恢复图像
- **性能优化**：根据设备内存自动调整编码文件大小限制（4GB以下内存：5MB，16GB以上内存：20MB）

### 📊 版本管理系统
- **动态版本显示**：状态栏实时显示当前版本号
- **配置文件管理**：版本信息从app.info文件读取，便于版本控制
- **界面优化**：版本号和状态信息分离显示，避免重叠问题

## 🔧 技术改进

### 性能优化
- **后台处理**：哈希值和base64编码计算在后台线程进行，不影响UI响应
- **内存适配**：根据设备性能动态调整处理策略
- **智能跳过**：空内容智能跳过保存操作，减少无效IO

### 用户体验
- **状态栏重构**：版本号和状态信息清晰分离，格式为"v版本号 | 状态信息"
- **菜单增强**：新增"设置"菜单，提供自动保存开关
- **确认对话框**：手动保存模式下的友好保存确认提示

### 数据格式
**新版JSON格式：**
```json
{
  "filename": "IMG_001.jpg",
  "hash": "a1b2c3d4e5f6...",
  "annotation": "图片描述内容",
  "file_size": 2048576,
  "base64_data": "iVBORw0KGgoAAAANSUhEUgAA..."
}
```

**移除字段：**
- 移除了`file_path`字段，避免绝对路径问题，便于文件传递和共享

## 🚀 升级建议

### 从v0.0.1升级
1. **无需特殊操作**：程序自动兼容旧版本数据
2. **建议备份**：升级前建议备份现有的labels.json文件
3. **新功能体验**：升级后可在"设置"菜单中体验新的自动保存功能

### 新用户
- 直接使用最新版本，享受所有新功能
- 建议在"文件"菜单中设置自定义保存路径以获得最佳体验

## 📋 完整功能列表

- ✅ 智能图片管理（SHA256哈希值）
- ✅ 分片加载策略（大量图片高效处理）
- ✅ 灵活保存方式（自动/手动模式）
- ✅ 自定义保存路径
- ✅ 数据备份保护（base64编码）
- ✅ 直观界面（左右布局）
- ✅ 进度跟踪（实时显示）
- ✅ 版本管理（动态显示）
- ✅ 向后兼容（支持旧格式）

## 🐛 问题修复

- 修复了状态栏版本号与状态信息重叠的显示问题
- 修复了关闭程序时空内容仍会保存的逻辑错误
- 优化了JSON文件格式，移除了不必要的绝对路径信息

---

**下载地址：** [GitHub Releases](https://github.com/xinyang20/quick_label/releases)

**技术支持：** [Issues](https://github.com/xinyang20/quick_label/issues)

感谢您使用Quick Label！🎯
